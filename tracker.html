<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Waterjet Run Tracker</title>

  <style>
    :root{
      --bg:#f7f9fc;
      --text:#111111;
      --muted:#52606d;

      --border:#d6dde6;
      --soft:#f1f5f9;

      --btn-bg:#eef2f7;
      --btn-text:#111111;
      --btn-hover:#197a3a;

      --primary-bg:#1f3b6d;
      --primary-text:#ffffff;
      --primary-hover:#2563eb;

      --danger:#b42318;
      --good:#197a3a;
    }

    body{
      margin:0;
      padding:0;
      background:var(--bg);
      color:var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    /* compact header INSIDE iframe (closest possible to Trello gray header placement) */
    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:8px 10px;
      border-bottom:1px solid var(--border);
      background: linear-gradient(#f6f8fb, #eef2f7);
      position:sticky;
      top:0;
      z-index:5;
    }
    .topTitle{
      font-weight:950;
      font-size:13px;
      color:#222;
      display:flex;
      align-items:center;
      gap:8px;
      white-space:nowrap;
    }
    .dot{
      width:8px;height:8px;border-radius:999px;background:var(--good);
      box-shadow:0 0 0 3px rgba(30,155,75,.12);
    }

    .primaryBtn{
      border:1px solid var(--primary-bg);
      background:var(--primary-bg);
      color:var(--primary-text);
      border-radius:12px;
      padding:8px 10px;
      font-weight:950;
      cursor:pointer;
      user-select:none;
      white-space:nowrap;
      font-size:13px;
    }
    .primaryBtn:hover{
      border-color:var(--primary-hover);
      background:var(--primary-hover);
    }

    #container{
      padding:10px;
      padding-top:8px;
    }

    .empty{
      padding:12px;
      border:1px dashed var(--border);
      border-radius:12px;
      background:var(--soft);
      color:var(--muted);
      font-weight:900;
      font-size:13px;
    }

    .tracker{
      border:1px solid var(--border);
      border-radius:14px;
      padding:10px;
      background:#fff;
      box-shadow: 0 1px 0 rgba(0,0,0,0.04);
      margin-bottom:10px;
    }

    .head{
      display:flex;
      justify-content:space-between;
      gap:10px;
      align-items:flex-start;
      margin-bottom:8px;
    }

    .title{
      font-size:14px;
      font-weight:950;
      line-height:1.15;
    }
    .sub{
      margin-top:4px;
      color:var(--muted);
      font-size:12px;
      font-weight:800;
    }

    .actions{
      display:flex;
      gap:6px;
      flex-wrap:wrap;
      justify-content:flex-end;
    }

    .btn{
      border:1px solid var(--border);
      background:var(--btn-bg);
      color:var(--btn-text);
      border-radius:10px;
      padding:7px 10px;
      font-weight:950;
      cursor:pointer;
      user-select:none;
      font-size:12px;
    }
    .btn:hover{
      border-color:var(--btn-hover);
      color:var(--btn-hover);
    }

    .btnDanger{
      border-color:#ffb3be;
      background:#fff;
      color:var(--danger);
    }
    .btnDanger:hover{
      border-color:var(--danger);
      color:var(--danger);
    }

    /* focus bar */
    .focusBar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin:6px 0 8px 0;
      flex-wrap:wrap;
    }
    .focusLeft{
      display:flex;
      gap:6px;
      flex-wrap:wrap;
      align-items:center;
    }
    .focusLabel{
      font-size:12px;
      font-weight:950;
      color:var(--muted);
      margin-right:4px;
    }
    .chip{
      border:1px solid var(--border);
      background:#fff;
      color:var(--btn-text);
      border-radius:999px;
      padding:6px 10px;
      font-weight:950;
      cursor:pointer;
      user-select:none;
      font-size:12px;
      line-height:1;
    }
    .chip:hover{
      border-color:var(--btn-hover);
      color:var(--btn-hover);
    }
    .chip.on{
      background:rgba(30,155,75,.12);
      border-color:rgba(30,155,75,.5);
      color:#0a6f2d;
    }

    .iconBtn{
      border:1px solid var(--border);
      background:#fff;
      border-radius:10px;
      padding:6px 8px;
      font-weight:950;
      cursor:pointer;
      user-select:none;
      font-size:12px;
      line-height:1;
    }
    .iconBtn:hover{
      border-color:var(--btn-hover);
      color:var(--btn-hover);
    }

    .totalBox{
      border:1px solid var(--border);
      border-radius:12px;
      padding:8px 10px;
      background:var(--soft);
      margin-bottom:8px;
    }
    .totalTop{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      font-weight:950;
      font-size:12px;
    }

    .pill{
      padding:4px 8px;
      border-radius:999px;
      font-size:12px;
      font-weight:950;
      border:1px solid var(--border);
      background:#fff;
      display:inline-block;
      margin-top:6px;
    }
    .pillOver{ border-color:#ffb3be; color:var(--danger); }
    .pillUnder{ border-color:#bfe9c6; color:var(--good); }

    .barWrap{
      height:9px;
      border-radius:999px;
      background:#eaeaea;
      overflow:hidden;
      border:1px solid #d2d2d2;
      margin-top:6px;
    }
    .barFill{ height:100%; width:0%; background:var(--primary-bg); }
    .barOver{ border-color:#ffb3be; }
    .barOver .barFill{ background:var(--danger); }

    .sectionTitle{
      margin:8px 0 6px;
      font-weight:950;
      font-size:12px;
      color:var(--muted);
      text-transform:uppercase;
      letter-spacing:.4px;
    }

    .breakdown{
      border:1px solid var(--border);
      border-radius:12px;
      background:#fff;
      padding:10px;
      margin-top:10px;
    }

    .breakdownHeader{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:6px;
    }

    .bdName{
      font-weight:950;
      font-size:13px;
      line-height:1.1;
      display:flex;
      align-items:center;
      gap:8px;
    }

    .bdBadges{
      display:flex;
      gap:6px;
      flex-wrap:wrap;
    }
    .bdBadge{
      display:inline-block;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid rgba(31,59,109,.25);
      background:rgba(31,59,109,.08);
      color:#14213d;
      font-size:11px;
      font-weight:950;
      line-height:1;
      white-space:nowrap;
    }

    .bdMeta{
      font-weight:950;
      color:var(--muted);
      font-size:12px;
      white-space:nowrap;
      display:flex;
      align-items:center;
      gap:8px;
    }

    .jets{
      display:flex;
      flex-direction:column;
      gap:8px;
    }

    .jetRow{
      border:1px solid var(--border);
      border-radius:12px;
      padding:8px 10px;
      background:#fff;
    }

    .jetHeader{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      margin-bottom:6px;
    }

    .jetMeta{
      display:flex;
      align-items:center;
      gap:8px;
      justify-content:flex-end;
      flex-wrap:wrap;
    }
    .jetTargetLabel{
      font-size:12px;
      font-weight:950;
      color:var(--muted);
      white-space:nowrap;
    }

    .jetName{
      font-weight:950;
      font-size:13px;
      white-space:nowrap;
    }

    .status{
      font-weight:950;
      font-size:12px;
      color:var(--muted);
      white-space:nowrap;
    }
    .statusOver{ color:var(--danger); }
    .statusUnder{ color:var(--good); }

    .controls{
      display:flex;
      align-items:center;
      gap:8px;
      justify-content:space-between;
      margin-top:6px;
    }

    .pm{
      width:40px;
      height:40px;
      border-radius:12px;
      border:1px solid var(--border);
      background:var(--btn-bg);
      color:var(--btn-text);
      font-weight:950;
      font-size:20px;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      user-select:none;
    }
    .pm:hover{
      border-color:var(--btn-hover);
      color:var(--btn-hover);
    }

    input[type=number]::-webkit-outer-spin-button,
    input[type=number]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    input[type=number] { -moz-appearance: textfield; }

    .num{
      flex:1;
      height:40px;
      border:1px solid var(--border);
      border-radius:12px;
      padding:0 10px;
      font-size:16px;
      font-weight:950;
      text-align:center;
      min-width:96px;
      color:var(--text);
      background:#fff;
    }

    .max{
      min-width:110px;
      text-align:right;
      color:var(--muted);
      font-weight:950;
      white-space:nowrap;
      font-size:12px;
    }

    .collapsedNote{
      margin-top:8px;
      padding:10px;
      border-radius:12px;
      border:1px dashed var(--border);
      background:#fff;
      color: var(--muted);
      font-weight:900;
      font-size:12px;
    }
  </style>
</head>

<body>
  <div class="topbar">
    <div class="topTitle"><span class="dot"></span> Waterjet Run Tracker</div>
    <button class="primaryBtn" id="addTrackerBtn">+ Add Tracker</button>
  </div>

  <div id="container"></div>

  <script src="https://p.trellocdn.com/power-up.min.js"></script>
  <script src="./tracker.js"></script>
</body>
</html>
